#!/usr/bin/env bash
set -euo pipefail

usage() {
    echo "Usage: $0 <markdown-file>"
    echo "  Convert Marp markdown to PowerPoint (.pptx)"
    echo ""
    echo "Example:"
    echo "  $0 docs/slide/lt-lambda-kansai.md"
    exit 1
}

if [[ $# -lt 1 ]]; then
    usage
fi

MD_FILE="$1"

if [[ ! -f "$MD_FILE" ]]; then
    echo "Error: File not found: $MD_FILE"
    exit 1
fi

if [[ ! "$MD_FILE" =~ \.md$ ]]; then
    echo "Error: File must be a .md file: $MD_FILE"
    exit 1
fi

PPTX_FILE="${MD_FILE%.md}.pptx"

echo "Converting: $MD_FILE -> $PPTX_FILE"
npx @marp-team/marp-cli@latest "$MD_FILE" --pptx -o "$PPTX_FILE"
echo "Done: $PPTX_FILE"
